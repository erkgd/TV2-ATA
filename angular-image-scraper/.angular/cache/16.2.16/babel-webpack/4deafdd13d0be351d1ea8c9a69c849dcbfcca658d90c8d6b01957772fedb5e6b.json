{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"../../services/image.service\";\nimport * as i4 from \"../../services/auth.service\";\nimport * as i5 from \"@angular/common\";\nfunction ImageDetailComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4);\n    i0.ɵɵelement(1, \"div\", 5);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImageDetailComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.error, \" \");\n  }\n}\nfunction ImageDetailComponent_ng_container_3_span_63_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 47);\n    i0.ɵɵtext(1, \"Free to use\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImageDetailComponent_ng_container_3_span_64_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 47);\n    i0.ɵɵtext(1, \"Free for commercial use\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImageDetailComponent_ng_container_3_span_65_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 48);\n    i0.ɵɵtext(1, \"Free for noncommercial use only\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImageDetailComponent_ng_container_3_span_66_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 47);\n    i0.ɵɵtext(1, \"Free to modify\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImageDetailComponent_ng_container_3_span_67_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 49);\n    i0.ɵɵtext(1, \"Unknown\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImageDetailComponent_ng_container_3_div_72_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 54);\n    i0.ɵɵtext(1, \" Comment text is required and must be at least 2 characters \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImageDetailComponent_ng_container_3_div_72_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 14)(1, \"form\", 50);\n    i0.ɵɵlistener(\"ngSubmit\", function ImageDetailComponent_ng_container_3_div_72_Template_form_ngSubmit_1_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r14.submitComment());\n    });\n    i0.ɵɵelementStart(2, \"div\");\n    i0.ɵɵelement(3, \"textarea\", 51);\n    i0.ɵɵtemplate(4, ImageDetailComponent_ng_container_3_div_72_div_4_Template, 2, 0, \"div\", 52);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\")(6, \"button\", 53);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    let tmp_1_0;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroup\", ctx_r8.commentForm);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ((tmp_1_0 = ctx_r8.commentForm.get(\"text\")) == null ? null : tmp_1_0.invalid) && ((tmp_1_0 = ctx_r8.commentForm.get(\"text\")) == null ? null : tmp_1_0.touched));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r8.commentForm.invalid || ctx_r8.submittingComment);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r8.submittingComment ? \"Posting...\" : \"Post Comment\", \" \");\n  }\n}\nconst _c0 = function () {\n  return [\"/login\"];\n};\nconst _c1 = function (a0) {\n  return {\n    returnUrl: a0\n  };\n};\nfunction ImageDetailComponent_ng_container_3_div_73_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 55)(1, \"a\", 56);\n    i0.ɵɵtext(2, \"Log in to post a comment\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(2, _c0))(\"queryParams\", i0.ɵɵpureFunction1(3, _c1, \"/image/\" + ctx_r9.imageId));\n  }\n}\nfunction ImageDetailComponent_ng_container_3_div_75_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 57)(1, \"div\", 58)(2, \"div\", 59)(3, \"div\", 60)(4, \"h3\", 36);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"time\", 61);\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"date\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"p\", 62);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const comment_r16 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(comment_r16.user.username);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(8, 3, comment_r16.createdAt, \"medium\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(comment_r16.text);\n  }\n}\nfunction ImageDetailComponent_ng_container_3_div_76_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 63);\n    i0.ɵɵtext(1, \" No comments yet. Be the first to comment! \");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c2 = function (a1) {\n  return [\"/image\", a1];\n};\nfunction ImageDetailComponent_ng_container_3_div_78_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 65)(1, \"div\", 66);\n    i0.ɵɵelement(2, \"img\", 67);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 68)(4, \"h3\", 36)(5, \"a\", 69);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"p\", 70);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const similarImage_r18 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", similarImage_r18.thumbnailUrl, i0.ɵɵsanitizeUrl)(\"alt\", similarImage_r18.title);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(6, _c2, similarImage_r18.id));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(similarImage_r18.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", similarImage_r18.width, \"x\", similarImage_r18.height, \"\");\n  }\n}\nfunction ImageDetailComponent_ng_container_3_div_78_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"div\", 14)(2, \"h2\", 32);\n    i0.ɵɵtext(3, \"Similar Images\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"div\", 33);\n    i0.ɵɵtemplate(5, ImageDetailComponent_ng_container_3_div_78_div_5_Template, 9, 8, \"div\", 64);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r12 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r12.similarImages);\n  }\n}\nfunction ImageDetailComponent_ng_container_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 7)(2, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function ImageDetailComponent_ng_container_3_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r19 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r19.goBack());\n    });\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(3, \"svg\", 9);\n    i0.ɵɵelement(4, \"path\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \" Back \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(6, \"div\", 11)(7, \"div\", 12)(8, \"div\", 13)(9, \"div\", 14)(10, \"h1\", 15);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"p\", 16)(13, \"a\", 17);\n    i0.ɵɵtext(14, \"View original source\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(15, \"div\", 18);\n    i0.ɵɵelement(16, \"img\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\", 20)(18, \"div\", 21)(19, \"div\", 22)(20, \"button\", 23);\n    i0.ɵɵlistener(\"click\", function ImageDetailComponent_ng_container_3_Template_button_click_20_listener() {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r21.toggleLike());\n    });\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(21, \"svg\", 24);\n    i0.ɵɵelement(22, \"path\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(23, \"span\");\n    i0.ɵɵtext(24);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(25, \"div\", 26);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(26, \"svg\", 27);\n    i0.ɵɵelement(27, \"path\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(28, \"span\");\n    i0.ɵɵtext(29);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(30, \"div\", 29)(31, \"a\", 30);\n    i0.ɵɵtext(32, \" Download \");\n    i0.ɵɵelementEnd()()()()();\n    i0.ɵɵelementStart(33, \"div\", 31)(34, \"div\", 14)(35, \"h2\", 32);\n    i0.ɵɵtext(36, \"Image Information\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(37, \"div\", 33)(38, \"div\", 34)(39, \"div\", 35);\n    i0.ɵɵtext(40, \"Dimensions\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(41, \"div\", 36);\n    i0.ɵɵtext(42);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(43, \"div\", 34)(44, \"div\", 35);\n    i0.ɵɵtext(45, \"File Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(46, \"div\", 36);\n    i0.ɵɵtext(47);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(48, \"div\", 34)(49, \"div\", 35);\n    i0.ɵɵtext(50, \"File Size\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(51, \"div\", 36);\n    i0.ɵɵtext(52);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(53, \"div\", 34)(54, \"div\", 35);\n    i0.ɵɵtext(55, \"Transparency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(56, \"div\", 36);\n    i0.ɵɵtext(57);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(58, \"div\", 34)(59, \"div\", 35);\n    i0.ɵɵtext(60, \"Copyright\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(61, \"div\", 36)(62, \"span\", 37);\n    i0.ɵɵtemplate(63, ImageDetailComponent_ng_container_3_span_63_Template, 2, 0, \"span\", 38);\n    i0.ɵɵtemplate(64, ImageDetailComponent_ng_container_3_span_64_Template, 2, 0, \"span\", 38);\n    i0.ɵɵtemplate(65, ImageDetailComponent_ng_container_3_span_65_Template, 2, 0, \"span\", 39);\n    i0.ɵɵtemplate(66, ImageDetailComponent_ng_container_3_span_66_Template, 2, 0, \"span\", 38);\n    i0.ɵɵtemplate(67, ImageDetailComponent_ng_container_3_span_67_Template, 2, 0, \"span\", 40);\n    i0.ɵɵelementEnd()()()()();\n    i0.ɵɵelementStart(68, \"div\", 31)(69, \"div\", 14)(70, \"h2\", 32);\n    i0.ɵɵtext(71, \"Comments\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(72, ImageDetailComponent_ng_container_3_div_72_Template, 8, 4, \"div\", 41);\n    i0.ɵɵtemplate(73, ImageDetailComponent_ng_container_3_div_73_Template, 3, 5, \"div\", 42);\n    i0.ɵɵelementStart(74, \"div\", 33);\n    i0.ɵɵtemplate(75, ImageDetailComponent_ng_container_3_div_75_Template, 11, 6, \"div\", 43);\n    i0.ɵɵtemplate(76, ImageDetailComponent_ng_container_3_div_76_Template, 2, 0, \"div\", 44);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(77, \"div\", 45);\n    i0.ɵɵtemplate(78, ImageDetailComponent_ng_container_3_div_78_Template, 6, 1, \"div\", 46);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(11);\n    i0.ɵɵtextInterpolate(ctx_r2.image.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"href\", ctx_r2.image.sourceUrl, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"src\", ctx_r2.image.url, i0.ɵɵsanitizeUrl)(\"alt\", ctx_r2.image.title);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngClass\", ctx_r2.userLiked ? \"text-red-500\" : \"text-gray-500 hover:text-red-500\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵattribute(\"fill\", ctx_r2.userLiked ? \"currentColor\" : \"none\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r2.image.likesCount || 0);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r2.image.commentsCount || 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"href\", ctx_r2.image.url, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(11);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r2.image.width || \"Unknown\", \" \\u00D7 \", ctx_r2.image.height || \"Unknown\", \"px\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r2.image.fileType || \"Unknown\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r2.image.fileSize ? (ctx_r2.image.fileSize / 1024).toFixed(2) + \" KB\" : \"Unknown\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r2.image.isTransparent ? \"Yes\" : \"No\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngSwitch\", ctx_r2.image.copyrightStatus);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitchCase\", \"free\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitchCase\", \"commercial\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitchCase\", \"noncommercial\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitchCase\", \"modification\");\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.isLoggedIn);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r2.isLoggedIn);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.comments);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.comments.length === 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.similarImages.length > 0);\n  }\n}\nexport class ImageDetailComponent {\n  constructor(route, router, fb, imageService, authService) {\n    this.route = route;\n    this.router = router;\n    this.fb = fb;\n    this.imageService = imageService;\n    this.authService = authService;\n    this.imageId = null;\n    this.image = null;\n    this.similarImages = [];\n    this.comments = [];\n    this.userLiked = false;\n    this.isLoggedIn = false;\n    this.loading = true;\n    this.error = null;\n    this.submittingComment = false;\n    this.commentForm = this.fb.group({\n      text: ['', [Validators.required, Validators.minLength(2)]]\n    });\n  }\n  ngOnInit() {\n    this.isLoggedIn = this.authService.isLoggedIn();\n    this.route.paramMap.subscribe(params => {\n      this.imageId = params.get('id');\n      if (this.imageId) {\n        // Si el ID parece ser un MongoDB ID (cadena), lo convertimos a número para Django\n        if (this.isMongoId(this.imageId)) {\n          console.warn('MongoDB ID detectado, intente usar la API de Django con este ID:', this.imageId);\n        }\n        this.loadImage();\n      } else {\n        this.error = 'Image ID not provided';\n        this.loading = false;\n      }\n    });\n  }\n  // Helper method para detectar si es un MongoDB ID\n  isMongoId(id) {\n    return /^[0-9a-fA-F]{24}$/.test(id);\n  }\n  loadImage() {\n    if (!this.imageId) return;\n    this.loading = true;\n    this.imageService.getImageById(this.imageId).subscribe({\n      next: data => {\n        this.image = data;\n        this.userLiked = data.userLiked || false;\n        this.comments = data.comments || [];\n        this.similarImages = data.similarImages || [];\n        this.loading = false;\n      },\n      error: err => {\n        console.error('Error loading image', err);\n        this.error = 'Failed to load image details. Please try again.';\n        this.loading = false;\n      }\n    });\n  }\n  toggleLike() {\n    if (!this.isLoggedIn) {\n      this.router.navigate(['/login'], {\n        queryParams: {\n          returnUrl: this.router.url\n        }\n      });\n      return;\n    }\n    if (!this.imageId) return;\n    this.imageService.likeImage(this.imageId).subscribe({\n      next: response => {\n        this.userLiked = response.liked;\n        // Update likes count\n        if (this.image) {\n          if (response.liked) {\n            this.image.likesCount = (this.image.likesCount || 0) + 1;\n          } else {\n            this.image.likesCount = Math.max(0, (this.image.likesCount || 0) - 1);\n          }\n        }\n      },\n      error: err => {\n        console.error('Error toggling like', err);\n      }\n    });\n  }\n  submitComment() {\n    if (!this.isLoggedIn) {\n      this.router.navigate(['/login'], {\n        queryParams: {\n          returnUrl: this.router.url\n        }\n      });\n      return;\n    }\n    if (!this.imageId || this.commentForm.invalid) return;\n    const text = this.commentForm.get('text')?.value;\n    this.submittingComment = true;\n    this.imageService.addComment(this.imageId, text).subscribe({\n      next: comment => {\n        this.comments.unshift(comment);\n        this.commentForm.reset();\n        this.submittingComment = false;\n        // Update comments count\n        if (this.image) {\n          this.image.commentsCount = (this.image.commentsCount || 0) + 1;\n        }\n      },\n      error: err => {\n        console.error('Error adding comment', err);\n        this.submittingComment = false;\n      }\n    });\n  }\n  goBack() {\n    window.history.back();\n  }\n  static {\n    this.ɵfac = function ImageDetailComponent_Factory(t) {\n      return new (t || ImageDetailComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.ImageService), i0.ɵɵdirectiveInject(i4.AuthService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ImageDetailComponent,\n      selectors: [[\"app-image-detail\"]],\n      decls: 4,\n      vars: 3,\n      consts: [[1, \"max-w-6xl\", \"mx-auto\"], [\"class\", \"flex justify-center items-center py-12\", 4, \"ngIf\"], [\"class\", \"p-4 mb-8 bg-red-100 text-red-700 rounded-lg\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"flex\", \"justify-center\", \"items-center\", \"py-12\"], [1, \"animate-spin\", \"rounded-full\", \"h-12\", \"w-12\", \"border-t-2\", \"border-b-2\", \"border-blue-500\"], [1, \"p-4\", \"mb-8\", \"bg-red-100\", \"text-red-700\", \"rounded-lg\"], [1, \"mb-6\"], [1, \"inline-flex\", \"items-center\", \"text-sm\", \"font-medium\", \"text-blue-500\", \"hover:text-blue-700\", 3, \"click\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"fill\", \"none\", \"viewBox\", \"0 0 24 24\", \"stroke\", \"currentColor\", 1, \"h-4\", \"w-4\", \"mr-2\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M10 19l-7-7m0 0l7-7m-7 7h18\"], [1, \"grid\", \"grid-cols-1\", \"lg:grid-cols-3\", \"gap-8\"], [1, \"lg:col-span-2\"], [1, \"bg-white\", \"rounded-lg\", \"shadow-md\", \"overflow-hidden\"], [1, \"p-4\", \"border-b\"], [1, \"text-xl\", \"font-bold\"], [1, \"text-sm\", \"text-gray-500\", \"mt-1\"], [\"target\", \"_blank\", \"rel\", \"noopener noreferrer\", 1, \"text-blue-500\", \"hover:underline\", 3, \"href\"], [1, \"flex\", \"justify-center\", \"p-4\", \"bg-gray-50\"], [1, \"max-w-full\", \"max-h-[600px]\", \"object-contain\", 3, \"src\", \"alt\"], [1, \"p-4\", \"border-t\"], [1, \"flex\", \"flex-wrap\", \"justify-between\", \"items-center\"], [1, \"flex\", \"items-center\", \"space-x-6\", \"mb-4\", \"md:mb-0\"], [1, \"flex\", \"items-center\", \"space-x-1\", 3, \"ngClass\", \"click\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"viewBox\", \"0 0 24 24\", \"stroke\", \"currentColor\", 1, \"h-5\", \"w-5\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"], [1, \"flex\", \"items-center\", \"space-x-1\", \"text-gray-500\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"fill\", \"none\", \"viewBox\", \"0 0 24 24\", \"stroke\", \"currentColor\", 1, \"h-5\", \"w-5\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\"], [1, \"flex\", \"space-x-2\"], [\"download\", \"\", \"target\", \"_blank\", 1, \"bg-green-500\", \"hover:bg-green-600\", \"text-white\", \"font-medium\", \"py-1\", \"px-4\", \"rounded-lg\", \"text-sm\", 3, \"href\"], [1, \"bg-white\", \"rounded-lg\", \"shadow-md\", \"overflow-hidden\", \"mt-6\"], [1, \"text-lg\", \"font-semibold\"], [1, \"divide-y\"], [1, \"grid\", \"grid-cols-2\", \"p-4\"], [1, \"text-sm\", \"text-gray-600\"], [1, \"text-sm\", \"font-medium\"], [3, \"ngSwitch\"], [\"class\", \"text-green-700\", 4, \"ngSwitchCase\"], [\"class\", \"text-yellow-700\", 4, \"ngSwitchCase\"], [\"class\", \"text-gray-500\", 4, \"ngSwitchDefault\"], [\"class\", \"p-4 border-b\", 4, \"ngIf\"], [\"class\", \"p-4 border-b text-center\", 4, \"ngIf\"], [\"class\", \"p-4\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"p-4 text-center text-gray-500\", 4, \"ngIf\"], [1, \"lg:col-span-1\"], [\"class\", \"bg-white rounded-lg shadow-md overflow-hidden\", 4, \"ngIf\"], [1, \"text-green-700\"], [1, \"text-yellow-700\"], [1, \"text-gray-500\"], [1, \"space-y-4\", 3, \"formGroup\", \"ngSubmit\"], [\"formControlName\", \"text\", \"rows\", \"3\", \"placeholder\", \"Add your comment...\", 1, \"w-full\", \"p-2\", \"border\", \"border-gray-300\", \"rounded-md\", \"focus:ring-blue-500\", \"focus:border-blue-500\"], [\"class\", \"text-red-500 text-xs mt-1\", 4, \"ngIf\"], [\"type\", \"submit\", 1, \"bg-blue-500\", \"hover:bg-blue-600\", \"text-white\", \"font-medium\", \"py-1.5\", \"px-4\", \"rounded-lg\", \"disabled:opacity-50\", 3, \"disabled\"], [1, \"text-red-500\", \"text-xs\", \"mt-1\"], [1, \"p-4\", \"border-b\", \"text-center\"], [1, \"text-blue-500\", \"hover:underline\", 3, \"routerLink\", \"queryParams\"], [1, \"p-4\"], [1, \"flex\", \"items-start\"], [1, \"flex-grow\"], [1, \"flex\", \"items-center\", \"justify-between\"], [1, \"text-xs\", \"text-gray-500\"], [1, \"mt-1\", \"text-sm\", \"text-gray-700\"], [1, \"p-4\", \"text-center\", \"text-gray-500\"], [\"class\", \"p-4 flex items-center\", 4, \"ngFor\", \"ngForOf\"], [1, \"p-4\", \"flex\", \"items-center\"], [1, \"flex-shrink-0\"], [1, \"w-16\", \"h-16\", \"object-cover\", \"rounded\", 3, \"src\", \"alt\"], [1, \"ml-4\", \"flex-1\"], [1, \"hover:underline\", 3, \"routerLink\"], [1, \"text-xs\", \"text-gray-500\", \"mt-1\"]],\n      template: function ImageDetailComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0);\n          i0.ɵɵtemplate(1, ImageDetailComponent_div_1_Template, 2, 0, \"div\", 1);\n          i0.ɵɵtemplate(2, ImageDetailComponent_div_2_Template, 2, 1, \"div\", 2);\n          i0.ɵɵtemplate(3, ImageDetailComponent_ng_container_3_Template, 79, 24, \"ng-container\", 3);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.loading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.error);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading && !ctx.error && ctx.image);\n        }\n      },\n      dependencies: [i5.NgClass, i5.NgForOf, i5.NgIf, i5.NgSwitch, i5.NgSwitchCase, i5.NgSwitchDefault, i1.RouterLink, i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName, i5.DatePipe],\n      styles: [\"\\n\\n.back-button[_ngcontent-%COMP%] {\\n  transition: all 0.2s;\\n}\\n.back-button[_ngcontent-%COMP%]:hover {\\n  transform: translateX(-3px);\\n}\\n\\n.image-container[_ngcontent-%COMP%] {\\n  position: relative;\\n  overflow: hidden;\\n}\\n.image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\\n  transition: transform 0.3s ease-in-out;\\n}\\n.image-container[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%] {\\n  transform: scale(1.02);\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImltYWdlLWRldGFpbC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxrQ0FBQTtBQUNBO0VBQ0Usb0JBQUE7QUFDRjtBQUNFO0VBQ0UsMkJBQUE7QUFDSjs7QUFHQTtFQUNFLGtCQUFBO0VBQ0EsZ0JBQUE7QUFBRjtBQUVFO0VBQ0Usc0NBQUE7QUFBSjtBQUdFO0VBQ0Usc0JBQUE7QUFESiIsImZpbGUiOiJpbWFnZS1kZXRhaWwuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBJbWFnZSBkZXRhaWwgY29tcG9uZW50IHN0eWxlcyAqL1xyXG4uYmFjay1idXR0b24ge1xyXG4gIHRyYW5zaXRpb246IGFsbCAwLjJzO1xyXG4gIFxyXG4gICY6aG92ZXIge1xyXG4gICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC0zcHgpO1xyXG4gIH1cclxufVxyXG5cclxuLmltYWdlLWNvbnRhaW5lciB7XHJcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gIG92ZXJmbG93OiBoaWRkZW47XHJcbiAgXHJcbiAgaW1nIHtcclxuICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjNzIGVhc2UtaW4tb3V0O1xyXG4gIH1cclxuICBcclxuICAmOmhvdmVyIGltZyB7XHJcbiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMDIpO1xyXG4gIH1cclxufVxyXG4iXX0= */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9pbWFnZS1kZXRhaWwvaW1hZ2UtZGV0YWlsLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLGtDQUFBO0FBQ0E7RUFDRSxvQkFBQTtBQUNGO0FBQ0U7RUFDRSwyQkFBQTtBQUNKOztBQUdBO0VBQ0Usa0JBQUE7RUFDQSxnQkFBQTtBQUFGO0FBRUU7RUFDRSxzQ0FBQTtBQUFKO0FBR0U7RUFDRSxzQkFBQTtBQURKO0FBQ0EsZzRCQUFnNEIiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBJbWFnZSBkZXRhaWwgY29tcG9uZW50IHN0eWxlcyAqL1xyXG4uYmFjay1idXR0b24ge1xyXG4gIHRyYW5zaXRpb246IGFsbCAwLjJzO1xyXG4gIFxyXG4gICY6aG92ZXIge1xyXG4gICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC0zcHgpO1xyXG4gIH1cclxufVxyXG5cclxuLmltYWdlLWNvbnRhaW5lciB7XHJcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gIG92ZXJmbG93OiBoaWRkZW47XHJcbiAgXHJcbiAgaW1nIHtcclxuICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjNzIGVhc2UtaW4tb3V0O1xyXG4gIH1cclxuICBcclxuICAmOmhvdmVyIGltZyB7XHJcbiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMDIpO1xyXG4gIH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n    });\n  }\n}","map":{"version":3,"names":["Validators","i0","ɵɵelementStart","ɵɵelement","ɵɵelementEnd","ɵɵtext","ɵɵadvance","ɵɵtextInterpolate1","ctx_r1","error","ɵɵlistener","ImageDetailComponent_ng_container_3_div_72_Template_form_ngSubmit_1_listener","ɵɵrestoreView","_r15","ctx_r14","ɵɵnextContext","ɵɵresetView","submitComment","ɵɵtemplate","ImageDetailComponent_ng_container_3_div_72_div_4_Template","ɵɵproperty","ctx_r8","commentForm","tmp_1_0","get","invalid","touched","submittingComment","ɵɵpureFunction0","_c0","ɵɵpureFunction1","_c1","ctx_r9","imageId","ɵɵtextInterpolate","comment_r16","user","username","ɵɵpipeBind2","createdAt","text","similarImage_r18","thumbnailUrl","ɵɵsanitizeUrl","title","_c2","id","ɵɵtextInterpolate2","width","height","ImageDetailComponent_ng_container_3_div_78_div_5_Template","ctx_r12","similarImages","ɵɵelementContainerStart","ImageDetailComponent_ng_container_3_Template_button_click_2_listener","_r20","ctx_r19","goBack","ɵɵnamespaceSVG","ɵɵnamespaceHTML","ImageDetailComponent_ng_container_3_Template_button_click_20_listener","ctx_r21","toggleLike","ImageDetailComponent_ng_container_3_span_63_Template","ImageDetailComponent_ng_container_3_span_64_Template","ImageDetailComponent_ng_container_3_span_65_Template","ImageDetailComponent_ng_container_3_span_66_Template","ImageDetailComponent_ng_container_3_span_67_Template","ImageDetailComponent_ng_container_3_div_72_Template","ImageDetailComponent_ng_container_3_div_73_Template","ImageDetailComponent_ng_container_3_div_75_Template","ImageDetailComponent_ng_container_3_div_76_Template","ImageDetailComponent_ng_container_3_div_78_Template","ɵɵelementContainerEnd","ctx_r2","image","sourceUrl","url","userLiked","ɵɵattribute","likesCount","commentsCount","fileType","fileSize","toFixed","isTransparent","copyrightStatus","isLoggedIn","comments","length","ImageDetailComponent","constructor","route","router","fb","imageService","authService","loading","group","required","minLength","ngOnInit","paramMap","subscribe","params","isMongoId","console","warn","loadImage","test","getImageById","next","data","err","navigate","queryParams","returnUrl","likeImage","response","liked","Math","max","value","addComment","comment","unshift","reset","window","history","back","ɵɵdirectiveInject","i1","ActivatedRoute","Router","i2","FormBuilder","i3","ImageService","i4","AuthService","selectors","decls","vars","consts","template","ImageDetailComponent_Template","rf","ctx","ImageDetailComponent_div_1_Template","ImageDetailComponent_div_2_Template","ImageDetailComponent_ng_container_3_Template"],"sources":["C:\\Users\\aleja\\Desktop\\BINFO\\ATA\\image-crawler\\angular-image-scraper\\src\\app\\components\\image-detail\\image-detail.component.ts","C:\\Users\\aleja\\Desktop\\BINFO\\ATA\\image-crawler\\angular-image-scraper\\src\\app\\components\\image-detail\\image-detail.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { Image, Comment } from '../../models';\r\nimport { ImageService } from '../../services/image.service';\r\nimport { AuthService } from '../../services/auth.service';\r\n\r\n@Component({\r\n  selector: 'app-image-detail',\r\n  templateUrl: './image-detail.component.html',\r\n  styleUrls: ['./image-detail.component.scss']\r\n})\r\nexport class ImageDetailComponent implements OnInit {\r\n  imageId: string | null = null;\r\n  image: Image | null = null;\r\n  similarImages: Image[] = [];\r\n  comments: Comment[] = [];\r\n  userLiked = false;\r\n  isLoggedIn = false;\r\n  loading = true;\r\n  error: string | null = null;\r\n  \r\n  commentForm: FormGroup;\r\n  submittingComment = false;\r\n  \r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    private fb: FormBuilder,\r\n    private imageService: ImageService,\r\n    private authService: AuthService\r\n  ) {\r\n    this.commentForm = this.fb.group({\r\n      text: ['', [Validators.required, Validators.minLength(2)]]\r\n    });\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.isLoggedIn = this.authService.isLoggedIn();\r\n    this.route.paramMap.subscribe(params => {\r\n      this.imageId = params.get('id');\r\n      if (this.imageId) {\r\n        // Si el ID parece ser un MongoDB ID (cadena), lo convertimos a número para Django\r\n        if (this.isMongoId(this.imageId)) {\r\n          console.warn('MongoDB ID detectado, intente usar la API de Django con este ID:', this.imageId);\r\n        }\r\n        this.loadImage();\r\n      } else {\r\n        this.error = 'Image ID not provided';\r\n        this.loading = false;\r\n      }\r\n    });\r\n  }\r\n  \r\n  // Helper method para detectar si es un MongoDB ID\r\n  private isMongoId(id: string): boolean {\r\n    return /^[0-9a-fA-F]{24}$/.test(id);\r\n  }\r\n\r\n  loadImage(): void {\r\n    if (!this.imageId) return;\r\n    \r\n    this.loading = true;\r\n    this.imageService.getImageById(this.imageId).subscribe({\r\n      next: (data) => {\r\n        this.image = data;\r\n        this.userLiked = data.userLiked || false;\r\n        this.comments = data.comments || [];\r\n        this.similarImages = data.similarImages || [];\r\n        this.loading = false;\r\n      },\r\n      error: (err) => {\r\n        console.error('Error loading image', err);\r\n        this.error = 'Failed to load image details. Please try again.';\r\n        this.loading = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  toggleLike(): void {\r\n    if (!this.isLoggedIn) {\r\n      this.router.navigate(['/login'], { queryParams: { returnUrl: this.router.url } });\r\n      return;\r\n    }\r\n\r\n    if (!this.imageId) return;\r\n    \r\n    this.imageService.likeImage(this.imageId).subscribe({\r\n      next: (response) => {\r\n        this.userLiked = response.liked;\r\n        \r\n        // Update likes count\r\n        if (this.image) {\r\n          if (response.liked) {\r\n            this.image.likesCount = (this.image.likesCount || 0) + 1;\r\n          } else {\r\n            this.image.likesCount = Math.max(0, (this.image.likesCount || 0) - 1);\r\n          }\r\n        }\r\n      },\r\n      error: (err) => {\r\n        console.error('Error toggling like', err);\r\n      }\r\n    });\r\n  }\r\n\r\n  submitComment(): void {\r\n    if (!this.isLoggedIn) {\r\n      this.router.navigate(['/login'], { queryParams: { returnUrl: this.router.url } });\r\n      return;\r\n    }\r\n\r\n    if (!this.imageId || this.commentForm.invalid) return;\r\n    \r\n    const text = this.commentForm.get('text')?.value;\r\n    this.submittingComment = true;\r\n    \r\n    this.imageService.addComment(this.imageId, text).subscribe({\r\n      next: (comment) => {\r\n        this.comments.unshift(comment);\r\n        this.commentForm.reset();\r\n        this.submittingComment = false;\r\n        \r\n        // Update comments count\r\n        if (this.image) {\r\n          this.image.commentsCount = (this.image.commentsCount || 0) + 1;\r\n        }\r\n      },\r\n      error: (err) => {\r\n        console.error('Error adding comment', err);\r\n        this.submittingComment = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  goBack(): void {\r\n    window.history.back();\r\n  }\r\n}\r\n","<div class=\"max-w-6xl mx-auto\">\r\n  <div *ngIf=\"loading\" class=\"flex justify-center items-center py-12\">\r\n    <div class=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\r\n  </div>\r\n\r\n  <div *ngIf=\"error\" class=\"p-4 mb-8 bg-red-100 text-red-700 rounded-lg\">\r\n    {{ error }}\r\n  </div>\r\n\r\n  <ng-container *ngIf=\"!loading && !error && image\">\r\n    <div class=\"mb-6\">\r\n      <button (click)=\"goBack()\" class=\"inline-flex items-center text-sm font-medium text-blue-500 hover:text-blue-700\">\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-4 w-4 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 19l-7-7m0 0l7-7m-7 7h18\" />\r\n        </svg>\r\n        Back\r\n      </button>\r\n    </div>\r\n\r\n    <div class=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n      <div class=\"lg:col-span-2\">\r\n        <div class=\"bg-white rounded-lg shadow-md overflow-hidden\">\r\n          <div class=\"p-4 border-b\">\r\n            <h1 class=\"text-xl font-bold\">{{ image.title }}</h1>\r\n            <p class=\"text-sm text-gray-500 mt-1\">\r\n              <a [href]=\"image.sourceUrl\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"text-blue-500 hover:underline\">View original source</a>\r\n            </p>\r\n          </div>\r\n          \r\n          <div class=\"flex justify-center p-4 bg-gray-50\">\r\n            <img [src]=\"image.url\" [alt]=\"image.title\" class=\"max-w-full max-h-[600px] object-contain\">\r\n          </div>\r\n          \r\n          <div class=\"p-4 border-t\">\r\n            <div class=\"flex flex-wrap justify-between items-center\">\r\n              <div class=\"flex items-center space-x-6 mb-4 md:mb-0\">\r\n                <button \r\n                  (click)=\"toggleLike()\" \r\n                  class=\"flex items-center space-x-1\"\r\n                  [ngClass]=\"userLiked ? 'text-red-500' : 'text-gray-500 hover:text-red-500'\"\r\n                >\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5\" [attr.fill]=\"userLiked ? 'currentColor' : 'none'\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\" />\r\n                  </svg>\r\n                  <span>{{ image.likesCount || 0 }}</span>\r\n                </button>\r\n                \r\n                <div class=\"flex items-center space-x-1 text-gray-500\">\r\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\r\n                  </svg>\r\n                  <span>{{ image.commentsCount || 0 }}</span>\r\n                </div>\r\n              </div>\r\n              \r\n              <div class=\"flex space-x-2\">\r\n                <a \r\n                  [href]=\"image.url\" \r\n                  download \r\n                  target=\"_blank\" \r\n                  class=\"bg-green-500 hover:bg-green-600 text-white font-medium py-1 px-4 rounded-lg text-sm\"\r\n                >\r\n                  Download\r\n                </a>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Image Information -->\r\n        <div class=\"bg-white rounded-lg shadow-md overflow-hidden mt-6\">\r\n          <div class=\"p-4 border-b\">\r\n            <h2 class=\"text-lg font-semibold\">Image Information</h2>\r\n          </div>\r\n          \r\n          <div class=\"divide-y\">\r\n            <div class=\"grid grid-cols-2 p-4\">\r\n              <div class=\"text-sm text-gray-600\">Dimensions</div>\r\n              <div class=\"text-sm font-medium\">{{ image.width || 'Unknown' }} × {{ image.height || 'Unknown' }}px</div>\r\n            </div>\r\n            \r\n            <div class=\"grid grid-cols-2 p-4\">\r\n              <div class=\"text-sm text-gray-600\">File Type</div>\r\n              <div class=\"text-sm font-medium\">{{ image.fileType || 'Unknown' }}</div>\r\n            </div>\r\n            \r\n            <div class=\"grid grid-cols-2 p-4\">\r\n              <div class=\"text-sm text-gray-600\">File Size</div>\r\n              <div class=\"text-sm font-medium\">{{ image.fileSize ? (image.fileSize / 1024).toFixed(2) + ' KB' : 'Unknown' }}</div>\r\n            </div>\r\n            \r\n            <div class=\"grid grid-cols-2 p-4\">\r\n              <div class=\"text-sm text-gray-600\">Transparency</div>\r\n              <div class=\"text-sm font-medium\">{{ image.isTransparent ? 'Yes' : 'No' }}</div>\r\n            </div>\r\n            \r\n            <div class=\"grid grid-cols-2 p-4\">\r\n              <div class=\"text-sm text-gray-600\">Copyright</div>\r\n              <div class=\"text-sm font-medium\">\r\n                <span [ngSwitch]=\"image.copyrightStatus\">\r\n                  <span *ngSwitchCase=\"'free'\" class=\"text-green-700\">Free to use</span>\r\n                  <span *ngSwitchCase=\"'commercial'\" class=\"text-green-700\">Free for commercial use</span>\r\n                  <span *ngSwitchCase=\"'noncommercial'\" class=\"text-yellow-700\">Free for noncommercial use only</span>\r\n                  <span *ngSwitchCase=\"'modification'\" class=\"text-green-700\">Free to modify</span>\r\n                  <span *ngSwitchDefault class=\"text-gray-500\">Unknown</span>\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Comments Section -->\r\n        <div class=\"bg-white rounded-lg shadow-md overflow-hidden mt-6\">\r\n          <div class=\"p-4 border-b\">\r\n            <h2 class=\"text-lg font-semibold\">Comments</h2>\r\n          </div>\r\n          \r\n          <div *ngIf=\"isLoggedIn\" class=\"p-4 border-b\">\r\n            <form [formGroup]=\"commentForm\" (ngSubmit)=\"submitComment()\" class=\"space-y-4\">\r\n              <div>\r\n                <textarea \r\n                  formControlName=\"text\"\r\n                  rows=\"3\"\r\n                  class=\"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500\"\r\n                  placeholder=\"Add your comment...\"\r\n                ></textarea>\r\n                <div *ngIf=\"commentForm.get('text')?.invalid && commentForm.get('text')?.touched\" class=\"text-red-500 text-xs mt-1\">\r\n                  Comment text is required and must be at least 2 characters\r\n                </div>\r\n              </div>\r\n              \r\n              <div>\r\n                <button \r\n                  type=\"submit\" \r\n                  class=\"bg-blue-500 hover:bg-blue-600 text-white font-medium py-1.5 px-4 rounded-lg disabled:opacity-50\"\r\n                  [disabled]=\"commentForm.invalid || submittingComment\"\r\n                >\r\n                  {{ submittingComment ? 'Posting...' : 'Post Comment' }}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n          \r\n          <div *ngIf=\"!isLoggedIn\" class=\"p-4 border-b text-center\">\r\n            <a [routerLink]=\"['/login']\" [queryParams]=\"{returnUrl: '/image/' + imageId}\" class=\"text-blue-500 hover:underline\">Log in to post a comment</a>\r\n          </div>\r\n          \r\n          <div class=\"divide-y\">\r\n            <div *ngFor=\"let comment of comments\" class=\"p-4\">\r\n              <div class=\"flex items-start\">\r\n                <div class=\"flex-grow\">\r\n                  <div class=\"flex items-center justify-between\">\r\n                    <h3 class=\"text-sm font-medium\">{{ comment.user.username }}</h3>\r\n                    <time class=\"text-xs text-gray-500\">{{ comment.createdAt | date:'medium' }}</time>\r\n                  </div>\r\n                  <p class=\"mt-1 text-sm text-gray-700\">{{ comment.text }}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <div *ngIf=\"comments.length === 0\" class=\"p-4 text-center text-gray-500\">\r\n              No comments yet. Be the first to comment!\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      <!-- Sidebar -->\r\n      <div class=\"lg:col-span-1\">\r\n        <!-- Similar Images -->\r\n        <div *ngIf=\"similarImages.length > 0\" class=\"bg-white rounded-lg shadow-md overflow-hidden\">\r\n          <div class=\"p-4 border-b\">\r\n            <h2 class=\"text-lg font-semibold\">Similar Images</h2>\r\n          </div>\r\n          \r\n          <div class=\"divide-y\">\r\n            <div *ngFor=\"let similarImage of similarImages\" class=\"p-4 flex items-center\">\r\n              <div class=\"flex-shrink-0\">\r\n                <img [src]=\"similarImage.thumbnailUrl\" [alt]=\"similarImage.title\" class=\"w-16 h-16 object-cover rounded\">\r\n              </div>\r\n              <div class=\"ml-4 flex-1\">\r\n                <h3 class=\"text-sm font-medium\">\r\n                  <a [routerLink]=\"['/image', similarImage.id]\" class=\"hover:underline\">{{ similarImage.title }}</a>\r\n                </h3>\r\n                <p class=\"text-xs text-gray-500 mt-1\">{{ similarImage.width }}x{{ similarImage.height }}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </ng-container>\r\n</div>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}